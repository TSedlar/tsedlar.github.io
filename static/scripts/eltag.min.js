const ELTAG_ELEMENT_TAGS=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"],ELTAG_ELEMENT_TRIGGERS=["onabort","onafterprint","onanimationend","onanimationiteration","onanimationstart","onbeforeprint","onbeforeunload","onblur","oncanplay","oncanplaythrough","onchange","onclick","oncontextmenu","oncopy","oncut","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onended","onerror","onfocus","onfocusin","onfocusout","onfullscreenchange","onfullscreenerror","onhashchange","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onmessage","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseover","onmouseout","onmouseup","onmousewheel","onoffline","ononline","onopen","onpagehide","onpageshow","onpaste","onpause","onplay","onplaying","onpopstate","onprogress","onratechange","onresize","onreset","onscroll","onsearch","onseeked","onseeking","onselect","onshow","onstalled","onstorage","onsubmit","onsuspend","ontimeupdate","ontoggle","ontouchcancel","ontouchend","ontouchmove","ontouchstart","ontransitionend","onunload","onvolumechange","onwaiting","onwheel"],PROPERTY_MAP=new Map,STATE_MAP=new Map,INIT_LIST=[],_visitTree=(e,o)=>{o(e);for(let n of e.children)_visitTree(n,o)},_renderTree=e=>_visitTree(e,e=>_rerender(e)),_createContextProxy=(e,o,n=null)=>{const t=new Proxy(o,{get:(e,o)=>n&&n[o]?n[o]:e[o],set:(e,o,t)=>(n?n[o]=t:e[o]=t,t)});return t.setState=(o=>{if(t.state)for(let e in t.state)e in o||(o[e]=t.state[e]);t.state=o;const n=PROPERTY_MAP.get(e);n&&n.ctx&&_renderTree(n.ctx)}),t},_rerender=e=>{const o=PROPERTY_MAP.get(e);if(o&&o.ctx&&o.render){const n=STATE_MAP.get(o.ctx);if(n){for(;e.firstChild;)e.removeChild(e.firstChild);const t=_runInContext(o.render,n);e.appendChild(document.createTextNode(t))}}},_initProps=()=>{for(let e of INIT_LIST){const o=PROPERTY_MAP.get(e);if(o&&!o.ctx){let n=e;for(;n.parentElement;){n=n.parentElement;const e=PROPERTY_MAP.get(n);if(e&&e.ctx){o.ctx=e.ctx;break}}}}INIT_LIST.length=0},_runInContext=(fn,context)=>(fn.hasOwnProperty("prototype")?fn:function(){return eval("("+fn+")()")}).call(context),ElTag={renderElement:(e,o)=>{_initProps(),_renderTree(o),e.appendChild(o)},el:(e,o={},n=[])=>{const t=document.createElement(e);INIT_LIST.push(t);const r=Array.isArray(o)?{}:o;let a=Array.isArray(o)?o:n||[];"string"==typeof o&&(a=o),r.state?(PROPERTY_MAP.set(t,{ctx:t,render:r.render}),STATE_MAP.set(t,_createContextProxy(t,{state:r.state}))):PROPERTY_MAP.set(t,{render:r.render}),r.style||(r.style={});for(let e of ELTAG_ELEMENT_TRIGGERS)if(r[e]){const o=r[e];r[e]=(()=>{const e=STATE_MAP.get(PROPERTY_MAP.get(t).ctx);_runInContext(o,_createContextProxy(t,{ref:t},e))})}for(let e in r)t[e]=r[e];r.class&&(t.className=r.class);for(let e in r.style)t.style[e]=r.style[e];if(Array.isArray(a))for(let e of a)"string"==typeof e?t.appendChild(document.createTextNode(e)):t.appendChild(e);else t.appendChild(document.createTextNode(a));return t},app:(e={},o=[])=>ElTag.el("div",e,o)};for(let e of ELTAG_ELEMENT_TAGS)ElTag[e]=((o={},n=[])=>ElTag.el(e,o,n));